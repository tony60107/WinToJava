Str f_micb_chk_sum_generator (string arg_bank_id, string arg_user_id, long arg_amt)
// 兆豐銀行客戶虛擬帳號檢核碼產生器
string  ls_valid_account, ls_id, ls_amt
integer li_i, li_j, li_value, li_remainder
integer li_value1, li_value2, li_value3, li_value4

if isnull(arg_bank_id) then arg_bank_id = ''
if isnull(arg_user_id) then arg_user_id = ''
if len(trim(arg_bank_id)) = 0 then return 'Fail'
if len(trim(arg_user_id)) = 0 then return 'Fail'
if len(trim(arg_bank_id)) + len(trim(arg_user_id)) = 13 then return 'Fail'
if isnull(arg_amt) then arg_amt = 0

