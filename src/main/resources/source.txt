select charge_sp.cargo_location, 
       charge_sp.work_type, 
		 charge_sp.charge_type,
		 to_char(to_date(charge_sp.start_date,'yyyy/mm/dd'),'yyyy/mm/dd'), 
		 to_char(to_date(charge_sp.end_date,'yyyy/mm/dd'),'yyyy/mm/dd'), 
		 charge_sp.vol_wet, 
		 charge_sp.wet, 
		 (charge_sp.ar_amount - nvl(charge_sp.db_amt,0)), 
		 decode(nvl(charge_sp.over_amount,0),0,0,nvl(charge_sp.over_amount,0) + (nvl(charge_sp.tax,0) - nvl(charge_sp.pay_tax,0))),
		 charge_sp.pay_amount,
		 charge_sp.tax, 
		 charge_sp.pay_tax,
		 charge_sp.prev_invoice_no,
		 charge_sp.storage_mark,
		 charge_sp.fee_date,
		 app05.app05_user_name,
		 charge_sp.fee_date, 
		 charge_sp.mwb_no,
		 charge_sp.mwb_no2, 
		 charge_sp.hwb_no, 
		 charge_sp.payment_type, 
		 charge_sp.apply_no,
		 charge_sp.gci_date, 
		 charge_sp.airline_id, 
		 charge_sp.flt_no, 
		 charge_sp.flt_date, 
		 charge_sp.agent_code,
		 charge_sp.custom_id, 
		 charge_sp.return_type,
		 charge_sp.upd_user,
		 nvl(registered_customer.inv_tax_adjust,'N') inv_tax_adjust,
		 nvl(charge_sp.over_amount,0),
		 decode(invoice_master.device_id,null,'Y','N') print_invoice
		 INTO :ls_cargo_location,
         			:ls_work_type,
         			:ls_charge_type,
         			:ls_start_date,
         			:ls_end_date,
         			:ld_vol_wet,
         			:ld_wet,
         			:ll_ar_amount,
         			:ll_over_amount,
         			:ll_pay_amount,
         			:ll_tax,
         			:ll_pay_tax,
         			:ls_prev_no,
         			:ls_storage_mark,
         			:ls_fee_date,
         			:ls_user_name,
         			:ls_fee_date,
         			:ls_mwb_no,
         			:ls_mwb_no2,
         			:ls_hwb_no,
         			:ls_payment_type,
         			:ls_apply_no,
         			:ls_gci_date,
         			:ls_airline_id,
         			:ls_flt_no,
         			:ls_flt_date,
         			:ls_agent_code,
         			:ls_custom_id,
         			:ls_return_type,
         			:ls_upd_user,
         			:ls_inv_tax_adjust,
         			:ll_over_amt_without_tax,
         			:ls_print_invoice
  from charge_sp, 
       invoice_master,
       app05,
		 registered_customer
 where charge_sp.invoice_no     = :invoice_no
	and charge_sp.invoice_no     = invoice_master.invoice_no
	and charge_sp.cargo_location = invoice_master.cargo_location
   and charge_sp.upd_user       = app05.app05_user_id 
	and charge_sp.cargo_location = registered_customer.cargo_location (+)
	and charge_sp.custom_id      = registered_customer.register_no    (+)
	  ;